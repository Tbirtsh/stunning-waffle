<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Collaborative Text Editor</title>
  <style>
    #editor {
      width: 100%;
      height: 500px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>Collaborative Text Editor</h1>
  <div id="editor" contenteditable="true"></div>
  <button id="share-btn">Share Document</button>

  <script>
    const editor = document.querySelector('#editor');
    const shareBtn = document.querySelector('#share-btn');

    let doc = '';

    shareBtn.addEventListener('click', () => {
      // Prompt the user to share the document using a WebRTC connection
      const connection = new RTCPeerConnection();

      connection.onicecandidate = (event) => {
        if (event.candidate) {
          // Send the ICE candidate to the other peer
          // This should be done over a signaling channel, such as WebSocket or Firebase Realtime Database
          console.log('Sending ICE candidate:', event.candidate);
        }
      };

      connection.ondatachannel = (event) => {
        const channel = event.channel;

        channel.onopen = () => {
          console.log('Data channel opened');
          channel.send(doc);
        };

        channel.onmessage = (event) => {
          console.log('Received message:', event.data);
          doc = event.data;
          editor.textContent = doc;
        };
      };

      const channel = connection.createDataChannel('document');
      channel.binaryType = 'arraybuffer';

      channel.onopen = () => {
        console.log('Data channel opened');
        channel.send(doc);
      };

      channel.onmessage = (event) => {
        console.log('Received message:', event.data);
        doc = event.data;
        editor.textContent = doc;
      };

      console.log('Creating data channel');

      // Offer a WebRTC connection to the other peer
      // This should be done over a signaling channel, such as WebSocket or Firebase Realtime Database
      console.log('Creating offer');
      connection.createOffer().then((offer) => {
        console.log('Setting local description');
        connection.setLocalDescription(offer).then(() => {
          console.log('Sending offer:', offer);
        });
      });
    });
  </script>
</body>
</html>
